<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Add Group Expense</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        .flash-messages {
    max-width: 600px;
    margin: 20px auto;
    text-align: center;
}

.alert {
    padding: 12px 20px;
    margin-bottom: 15px;
    border-radius: 6px;
    font-weight: bold;
}

.alert.success {
    background-color: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.alert.error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}

        body {
            font-family: Arial;
            padding: 20px;
            background-color: #f4f6f8;
        }

        h2 {
            color: #333;
        }

        .member {
            background: #fff;
            padding: 8px 15px;
            border-radius: 8px;
            margin: 5px;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
            display: inline-block;
        }

        form {
            background: #fff;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            max-width: 600px;
        }

        select, input, button {
            padding: 10px;
            width: 100%;
            margin-bottom: 15px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }

        .splits {
            margin-top: 10px;
            padding: 10px;
            background-color: #f7f7f7;
            border-radius: 8px;
        }

        .splits input {
            width: 80px;
            margin-left: 10px;
        }

        .expenses {
            margin-top: 40px;
        }

        .expenses table {
            width: 100%;
            border-collapse: collapse;
        }

        .expenses th, .expenses td {
            padding: 10px;
            border: 1px solid #ddd;
        }

        .expenses th {
            background: #eee;
        }

        .settle-btn {
            text-align: center;
            margin-top: 40px;
        }

        .settle-btn a {
            background: #4CAF50;
            color: white;
            padding: 12px 28px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease;
            margin: 0 10px;
            display: inline-block;
        }

        .settle-btn a:hover {
            background: #45a049;
        }

        .settle-btn a.back-btn {
            background-color: #3498db;
        }

        .settle-btn a.back-btn:hover {
            background-color: #2980b9;
        }
    </style>

    <script>
        function toggleSplitType(value) {
            const unequalDiv = document.getElementById("unequalSplits");
            unequalDiv.style.display = value === "unequal" ? "block" : "none";
        }
    </script>
</head>
<body>
    {% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-messages">
      {% for category, message in messages %}
        <div class="alert {{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

    <h2>Group Members</h2>
    <div>
        {% for person in people %}
            <div class="member">{{ person[1] }}</div>
        {% endfor %}
    </div>

    <h2>Add Expense</h2>
    <form method="POST">
        <label for="payer_id">Payer:</label>
        <select name="payer_id" required>
            {% for person in people %}
                <option value="{{ person[0] }}">{{ person[1] }}</option>
            {% endfor %}
        </select>

        <label for="amount">Amount:</label>
        <input type="number" name="amount" step="0.01" required>

        <label for="category">Category:</label>
        <select name="category" required>
            <option value="Food">üçî Food</option>
            <option value="Travel">üß≥ Travel</option>
            <option value="Restaurant">üçΩÔ∏è Restaurant</option>
            <option value="Petrol">‚õΩ Petrol</option>
            <option value="Other">üì¶ Other</option>
        </select>

        <label for="date">Date:</label>
        <input type="date" name="date" required >

        <label>Split Type:</label>
        <select name="split_type" onchange="toggleSplitType(this.value)">
            <option value="equal">Equal</option>
            <option value="unequal">Unequal</option>
        </select>

        <div id="unequalSplits" class="splits" style="display: none;">
            <strong>Enter individual shares:</strong><br><br>
            {% for person in people %}
                {{ person[1] }}:
                <input type="number" name="share_{{ person[0] }}" step="0.01" value="0"><br><br>
            {% endfor %}
        </div>

        <button type="submit">Add Expense</button>
    </form>

    <div class="settle-btn">
        <a href="{{ url_for('group') }}" class="back-btn"><i class="fas fa-arrow-left"></i> Back to Group</a>
    </div>

    <div class="expenses">
        <h2>Past Expenses</h2>
        <table>
            <tr>
                <th>Payer</th>
                <th>Amount</th>
                <th>Category</th>
                <th>Date</th>
            </tr>
            {% for expense in expenses %}
                <tr>
                    <td>{{ expense[3] }}</td>
                    <td>‚Çπ{{ expense[0] }}</td>
                    <td>{{ expense[1] }}</td>
                    <td>{{ expense[2] }}</td>
                </tr>
            {% endfor %}
        </table>
    </div>
    
</body>
</html>
